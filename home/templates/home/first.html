{% extends 'base.html '%}
{% load static %}
{% block styles %}
{% endblock %}

{% block content %}
  <button id="buttonStart" class="btn btn-primary mb-3">Ajax 開始</button>

  <div id="div1" class="alert alert-info"></div>

  {% endblock %}
{% block scripts %}

<script>
    const btnStart = document.querySelector('#buttonStart')
    const divInfo = document.querySelector('#div1')
    btnStart.addEventListener('click',async ()=>{

        // divInfo.innerHTML = 'Ajax 要開始了'
        //http://127.0.0.1:8000/api/
             
        const api = '/api'
        // console.log(fetch(api))


        // fetch(api)
        //     .then(response=>{
        //         console.log(response)
        //         response.headers.forEach((value, key)=>{
        //           console.log(`${key} : ${value}`)
        //         })
        //         console.log(response.ok)
        //         console.log(response.status)
        //         console.log(response.statusText)
        //         console.log(response.body)
        //         return response.text()
        //     })            
        //     .then(data=>{
        //         console.log(data)
        //         divInfo.innerHTML = data
        //     })

        //async await
        try{
          const response = await fetch(api)    
          if(!response.ok)  {
            //有問題會在這裡產生錯誤
            throw new Error(`${response.status}：${response.statusText}`)
          }
          const data = await response.text()
          divInfo.innerHTML = data
        }catch(error){
          divInfo.innerHTML = error.message
        }finally{
          
        }
        

    })
</script>
{% endblock %}